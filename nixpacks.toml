# nixpacks.toml
# Railway uses Nixpacks to build and run the app.

[variables]
MIX_ENV = "prod"

[phases.setup]
# git is needed for git-based deps (e.g. heroicons)
nixPkgs = ["elixir", "erlang", "git"]

[phases.install]
cmds = [
  "mix local.hex --force",
  "mix local.rebar --force",
  "mix deps.get --only prod"
]

[phases.build]
cmds = [
  "mix compile",
  "mix assets.deploy"
]

[start]
# Run migrations on boot, then start the server.
cmd = "mix ecto.migrate && mix phx.server"
